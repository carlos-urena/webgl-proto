<!DOCTYPE html>
<html 
   lang="en">
<head>
   <title>WebGL proto</title>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <meta name="locality"    content="Granada, España"/>
   <meta name="lang"        content="en"/>
   <meta name="author"      content="Carlos Ureña"/>
   <meta name="robots"      content="all" />
   <meta name="Keywords"    content="webgl,javascript,mesh,3d" />
   <meta name="Description" content="Prototype for WebGL 3D mesh visualization" />

   <meta name="viewport"    content="width=device-width, initial-scale=1">
   <link rel='stylesheet'   type='text/css' href='index-style.css'>
   <link rel="stylesheet"   href="https://fonts.googleapis.com/css2?family=Marcellus+SC">
   <link rel="stylesheet"   href="https://fonts.googleapis.com/css2?family=Crimson+Pro">
   <!-- script src='index-code.js'></script>  -->
</head>
<script>
// -------------------------------------------------------------------------------------------------

var gl        = null,  // WebGL rendering context
    gl_canvas = null   // canvas DOM element
    gl_ver    = 0      // = 0 -> WebGL not available, 1 -> WebGL ver. 1 available, 2 -> WebGL ver.2  

// -------------------------------------------------------------------------------------------------

function InitializeWebGL()
{
    console.log(`hello world`)
    let canvas_container = document.getElementById('canvas_container_id')
    if ( canvas_container === null )
        throw RangeError(`cannot find 'canvas_container_id' element`)
    
    if ( gl != null || gl_canvas != null || gl_ver != 0 )
        throw RangeError(`cannot create webgl context twice`)
    
    gl_canvas = document.getElementById('gl_canvas_id');
    if ( gl_canvas == null )
        throw RangeError(`cannot find 'gl_canvas' element`)

    gl_canvas.width = canvas_container.clientWidth
    gl_canvas.height = canvas_container.clientHeight

    gl_ver = 2 
    gl = gl_canvas.getContext('webgl2')
    if ( gl === null )
    {   
        gl_ver = 1 
        gl = gl_canvas.getContext('webgl')
    }
    if ( gl === null )
    {
        gl_ver = 0
        const str = 'Unable to initialize WebGL. Your browser or machine may not support it.'
        alert(str)
        return 
    }

    gl.clearColor(0.0, 0.2, 0.3, 1.0);
    gl.clear(gl.COLOR_BUFFER_BIT);


    let ctx_class = gl.constructor.name,
        gl_vendor = gl.getParameter(gl.VENDOR),
        gl_version = gl.getParameter(gl.VERSION)

    const info_str = 
            `<table style='background-color : rgb(80%,80%,80%);'>
                 <tr><td><i>class</i></td><td>${ctx_class}</td></tr> 
                 <tr><td><i>vendor</i></td><td>${gl_vendor}</td></tr>
                <tr><td><i>version</i></td><td>${gl_version}</td></tr>
            </table>`

    let info_div = document.getElementById('info_div_id')
    info_div.innerHTML = info_str
    
}
// -------------------------------------------------------------------------------------------------

function OnDocumentLoad()
{
    InitializeWebGL()
}

</script>
<!-- ***************************************************************************************** -->

<body onload="OnDocumentLoad()">

<h1>Lorem IPSUM.</h1>

<p>
This page bla bla ....
</p>

<div id='canvas_container_id' >
    <canvas id='gl_canvas_id'>
        Tu navegador u ordendor parece no soportar <code>&lt;canvas&gt;</code>.<br/>
        <i>Looks like your browser or computer does not support <code>&lt;canvas&gt;</code> element.</i>
    </canvas>

</div>
<hr noshade>
<div id='info_div_id'>
</div>

<!-- ***************************************************************************************** -->
</body>
</html>
